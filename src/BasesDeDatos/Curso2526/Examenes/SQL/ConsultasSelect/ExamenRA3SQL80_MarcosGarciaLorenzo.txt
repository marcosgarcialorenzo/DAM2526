EJERCICIO 1
-----------

SELECT num_ofi, SUM(ventas) AS total_ventas
FROM OFICINAS
WHERE ventas > 500000
GROUP BY num_ofi;







EJERCICIO 2
-----------


SELECT num_emp, nombre, ventas
FROM VENDEDORES V1
WHERE VENTAS > (SELECT AVG(VENTAS) 
                FROM VENDEDORES V2 
                WHERE V2.NUM_OFI = V1.NUM_OFI)
ORDER BY NUM_EMP;







EJERCICIO 3
-----------

SELECT num_emp, avg(ventas) AS prom_ventas
FROM VENDEDORES
WHERE ventas > 100000
GROUP BY num_emp;






EJERCICIO 4
-----------



SELECT NUM_EMP, MIN(LIMITE_CREDITO) as limite_minimo
FROM CLIENTES
GROUP BY NUM_EMP
ORDER BY NUM_EMP;



EJERCICIO 5
-----------


SELECT NUM_CLI, SUM(CANTI) as total_productos
FROM PEDIDOS
GROUP BY NUM_CLI
HAVING SUM(CANTI) >= 10
ORDER BY NUM_CLI;




EJERCICIO 6
-----------


SELECT NUM_OFI, CIUDAD
FROM OFICINAS
WHERE (SELECT AVG(VENTAS) FROM VENDEDORES V WHERE V.NUM_OFI = OFICINAS.NUM_OFI) > 
      (SELECT AVG(VENTAS) FROM VENDEDORES);

EJERCICIO 7
-----------




SELECT V.NUM_EMP, V.NOMBRE, V.VENTAS
FROM VENDEDORES V, OFICINAS O
WHERE V.NUM_OFI = O.NUM_OFI
  AND V.VENTAS >= O.VENTAS
ORDER BY V.NUM_EMP;



EJERCICIO 8
-----------


SELECT DISTINCT V.NUM_EMP, V.NOMBRE, V.VENTAS
FROM VENDEDORES V, CLIENTES C
WHERE V.NUM_EMP = C.NUM_EMP
AND V.VENTAS > C.LIMITE_CREDITO;

EJERCICIO 9
-----------

SELECT O.NUM_OFI, O.CIUDAD, SUM(P.IMPORTE) AS TOTAL_PEDIDOS
FROM OFICINAS O, VENDEDORES V, PEDIDOS P
WHERE O.NUM_OFI = V.NUM_OFI
AND V.NUM_EMP = P.NUM_EMP
GROUP BY O.NUM_OFI, O.CIUDAD
HAVING SUM(P.IMPORTE) > 50000;


EJERCICIO 10
------------





SELECT num_cli, empresa
FROM CLIENTES
WHERE NUM_CLI IN (
    SELECT NUM_CLI
    FROM PEDIDOS
    WHERE ID_PROD IN (
        SELECT ID_PROD
        FROM PRODUCTOS
        WHERE PRECIO > (SELECT AVG(PRECIO) FROM PRODUCTOS)
    )
)
ORDER BY NUM_CLI;




EJERCICIO 11
------------


SELECT DISTINCT V.NUM_EMP, V.NOMBRE
FROM VENDEDORES V, PEDIDOS P, PRODUCTOS PR
WHERE V.NUM_EMP = P.NUM_EMP
AND P.ID_FAB = PR.ID_FAB
AND P.ID_PROD = PR.ID_PROD
AND PR.PRECIO > (
    SELECT AVG(PR2.PRECIO)
    FROM PRODUCTOS PR2, PEDIDOS P2, VENDEDORES V2
    WHERE PR2.ID_FAB = P2.ID_FAB 
    AND PR2.ID_PROD = P2.ID_PROD
    AND P2.NUM_EMP = V2.NUM_EMP
    AND V2.NUM_OFI = V.NUM_OFI
)
ORDER BY V.NUM_EMP;

EJERCICIO 12
------------








SELECT num_ofi, ciudad, region, ventas
FROM OFICINAS O1
WHERE VENTAS > (
    SELECT SUM(VENTAS) - O1.VENTAS
    FROM OFICINAS O2
    WHERE O2.REGION = O1.REGION
);



EJERCICIO 13
------------



SELECT V.NUM_EMP, V.NOMBRE, AVG(C.LIMITE_CREDITO) AS CREDITO_MEDIO
FROM VENDEDORES V, CLIENTES C
WHERE V.NUM_EMP = C.NUM_EMP
GROUP BY V.NUM_EMP, V.NOMBRE
HAVING AVG(C.LIMITE_CREDITO) > 40000
ORDER BY V.NUM_EMP;


EJERCICIO 14
------------




SELECT id_prod, descripcion, existencias
FROM PRODUCTOS P1
WHERE EXISTENCIAS > (
    SELECT AVG(EXISTENCIAS)
    FROM PRODUCTOS P2
    WHERE P2.ID_FAB = P1.ID_FAB
)
ORDER BY EXISTENCIAS;




EJERCICIO 15
------------


SELECT num_cli, empresa
FROM CLIENTES C
WHERE LIMITE_CREDITO > (
    SELECT AVG(LIMITE_CREDITO)
    FROM CLIENTES C2
    WHERE C2.NUM_EMP IN (
        SELECT NUM_EMP 
        FROM VENDEDORES 
        WHERE NUM_OFI = (
            SELECT NUM_OFI 
            FROM VENDEDORES 
            WHERE NUM_EMP = C.NUM_EMP
        )
    )
)
ORDER BY NUM_CLI;


SELECT C.NUM_CLI, C.EMPRESA
FROM CLIENTES C, VENDEDORES V
WHERE C.NUM_EMP = V.NUM_EMP
AND C.LIMITE_CREDITO > (
    SELECT AVG(C2.LIMITE_CREDITO)
    FROM CLIENTES C2, VENDEDORES V2
    WHERE C2.NUM_EMP = V2.NUM_EMP
    AND V2.NUM_OFI = V.NUM_OFI
)
ORDER BY C.NUM_CLI;
